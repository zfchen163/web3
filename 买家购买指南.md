# 🛒 ChainVault 买家购买指南

## 📋 目录
1. [准备工作](#准备工作)
2. [连接钱包](#连接钱包)
3. [浏览市场](#浏览市场)
4. [查看资产详情](#查看资产详情)
5. [购买资产](#购买资产)
6. [订单管理](#订单管理)
7. [常见问题](#常见问题)

---

## 1. 准备工作

### 必需条件
- ✅ 安装 MetaMask 浏览器扩展
- ✅ MetaMask 账户有足够的 ETH（用于购买和 Gas 费）
- ✅ 连接到正确的区块链网络（本地测试网络或主网）

### 检查账户余额
1. 打开 MetaMask
2. 查看账户余额
3. 确保有足够的 ETH

---

## 2. 连接钱包

### 步骤
1. **打开 ChainVault**
   ```
   http://localhost:3000/index-native.html
   ```

2. **点击"连接钱包"按钮**
   - 位置：页面右上角
   - 图标：紫色渐变按钮

3. **MetaMask 弹窗确认**
   - 选择要连接的账户
   - 点击"下一步"
   - 点击"连接"

4. **连接成功**
   - 右上角显示您的账户地址
   - 例如：`0xf39F...2266`

---

## 3. 浏览市场

### 进入市场页面

连接钱包后，默认显示"市场"页面，显示所有在售资产。

### 市场页面布局

```
┌────────────────────────────────────────────┐
│ 🛒 市场                                     │
├────────────────────────────────────────────┤
│ [🔍 搜索框]              [搜索] [🔄 刷新]   │
├────────────────────────────────────────────┤
│                                            │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐   │
│  │ [图片]  │  │ [图片]  │  │ [图片]  │   │
│  │ 资产名称 │  │ 资产名称 │  │ 资产名称 │   │
│  │ ✅ 已验证│  │ ⏳ 待验证│  │ ✅ 已验证│   │
│  │ SN:123  │  │ SN:456  │  │ SN:789  │   │
│  │ 所有者   │  │ 所有者   │  │ 所有者   │   │
│  │ 💰 1.5 ETH│ │ 💰 2.0 ETH│ │ 💰 0.8 ETH│ │
│  │[详情][购买]│ │[详情][购买]│ │[详情][购买]│ │
│  └─────────┘  └─────────┘  └─────────┘   │
│                                            │
└────────────────────────────────────────────┘
```

### 资产卡片信息

每个资产卡片显示：
- 📷 **资产图片**
- 📝 **资产名称**（例如：Chanel 腰带）
- ✅ **验证状态**（已验证/待验证/未验证）
- 🔢 **序列号**（例如：CHANEL-ITEM-20260112-4108）
- 👤 **所有者地址**（缩略显示）
- 💰 **价格**（单位：ETH）
- 🔘 **操作按钮**：
  - "查看详情" - 查看完整信息
  - "购买" - 立即购买

### 搜索功能

1. **输入搜索关键词**
   - 可以搜索资产名称
   - 可以搜索序列号
   - 可以搜索所有者地址

2. **点击"搜索"按钮**
   - 或按 Enter 键

3. **查看搜索结果**
   - 匹配的资产会显示在列表中

---

## 4. 查看资产详情

### 打开详情页面

点击任意资产卡片上的"查看详情"按钮

### 详情页面内容

```
┌────────────────────────────────────────┐
│ 资产详情                        [×]    │
├────────────────────────────────────────┤
│                                        │
│  [资产图片轮播]                         │
│  ● ○ ○ ○                               │
│                                        │
│  Chanel 腰带                  ✅ 已验证 │
│                                        │
│  资产 ID: 2                            │
│  序列号: CHANEL-ITEM-20260112-4108     │
│                                        │
│  ┌──────────────────────────────────┐ │
│  │ 所有者地址                        │ │
│  │ 0xf39Fd6e51aad88F6F4ce6aB8827... │ │
│  │                      [📋 复制]    │ │
│  └──────────────────────────────────┘ │
│                                        │
│  ┌──────────────────────────────────┐ │
│  │ 品牌地址                          │ │
│  │ 0xf39Fd6e51aad88F6F4ce6aB8827... │ │
│  │                      [📋 复制]    │ │
│  └──────────────────────────────────┘ │
│                                        │
│  价格: 1.5 ETH                         │
│  创建时间: 2026-01-12 10:30:00        │
│                                        │
│  ┌──────────────────────────────────┐ │
│  │ 交易哈希                          │ │
│  │ 0x1234567890abcdef...            │ │
│  │                      [📋 复制]    │ │
│  └──────────────────────────────────┘ │
│                                        │
└────────────────────────────────────────┘
```

### 详情页面功能

1. **完整地址显示**
   - 所有者地址：完整显示，可复制
   - 品牌地址：完整显示，可复制
   - 交易哈希：完整显示，可复制

2. **图片轮播**
   - 如果有多张图片，可以左右滑动
   - 点击分页指示器切换

3. **复制功能**
   - 点击"📋 复制"按钮
   - 地址会自动复制到剪贴板
   - 显示"✅ 已复制!"提示

---

## 5. 购买资产

### 购买流程

#### 步骤 1: 选择资产
在市场页面找到想要购买的资产

#### 步骤 2: 点击"购买"按钮
- 位置：资产卡片底部
- 按钮：紫色渐变按钮

#### 步骤 3: MetaMask 确认

MetaMask 会弹出交易确认窗口：

```
┌─────────────────────────────────┐
│ MetaMask                        │
├─────────────────────────────────┤
│ 确认交易                         │
│                                 │
│ 从: 0xf39F...2266               │
│ 到: 0xDc64...C6C9 (合约)        │
│                                 │
│ 金额: 1.5 ETH                   │
│ Gas 费: 0.001 ETH               │
│ 总计: 1.501 ETH                 │
│                                 │
│     [拒绝]      [确认]          │
└─────────────────────────────────┘
```

**检查信息：**
- ✅ 金额是否正确
- ✅ Gas 费是否合理
- ✅ 账户余额是否足够

#### 步骤 4: 等待确认

点击"确认"后：

1. **提交交易**
   - 显示：⏳ 正在处理购买...

2. **等待区块链确认**
   - 显示：⏳ 等待交易确认...
   - 通常需要几秒到几分钟

3. **购买成功**
   - 显示：✅ 购买成功!
   - 页面自动刷新

#### 步骤 5: 查看订单

购买成功后：
1. 点击"我的订单"标签
2. 查看新创建的订单
3. 订单状态：已支付

---

## 6. 订单管理

### 查看订单

点击顶部导航的"📋 我的订单"标签

### 订单卡片信息

```
┌────────────────────────────────────┐
│ 订单 #1                  已支付    │
├────────────────────────────────────┤
│ 资产 ID: 2                         │
│ 价格: 1.5 ETH                      │
│ 卖家: 0xf39F...2266                │
│ 买家: 0x7099...C8 (您)             │
│                                    │
│ [等待卖家发货]                      │
└────────────────────────────────────┘
```

### 订单状态流程

```
已创建 → 已支付 → 已发货 → 已送达 → 已完成
   ↓        ↓        ↓        ↓
  取消     退款     退款     退款
```

### 买家操作

#### 1. 已支付状态
- **操作**：等待卖家发货
- **可选**：申请退款（如果超时）

#### 2. 已发货状态
- **操作**：确认收货
- **按钮**："确认收货"
- **说明**：收到商品后点击

#### 3. 已送达状态
- **操作**：完成交易
- **按钮**："完成交易"
- **说明**：确认商品无误后点击

#### 4. 申请退款
- **条件**：
  - 订单状态为已支付/已发货/已送达
  - 在退款期限内
- **按钮**："申请退款"
- **流程**：
  1. 点击"申请退款"
  2. MetaMask 确认
  3. 等待区块链确认
  4. 退款成功，ETH 返回账户

---

## 7. 常见问题

### Q1: 如何切换到买家账户？

**方法 1: 使用 MetaMask 切换**
1. 打开 MetaMask
2. 点击顶部账户图标
3. 选择其他账户
4. 刷新页面

**方法 2: 使用测试账户**

Hardhat 本地测试网络提供了 10 个测试账户：

```javascript
// 账户 #0 (通常是管理员/品牌方)
0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266

// 账户 #1 (可作为买家)
0x70997970C51812dc3A010C7d01b50e0d17dc79C8

// 账户 #2 (可作为买家)
0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC

// 更多账户...
```

**切换步骤：**
1. 在 MetaMask 中导入测试账户私钥
2. 或使用 MetaMask 的账户切换功能
3. 刷新 ChainVault 页面

### Q2: 如何查看卖家上架的资产？

**步骤：**
1. 连接买家账户
2. 点击"🛒 市场"标签
3. 所有在售资产会自动显示
4. 使用搜索功能查找特定资产

**筛选技巧：**
- 按名称搜索：输入资产名称
- 按序列号搜索：输入完整或部分序列号
- 按所有者搜索：输入卖家地址

### Q3: 购买时需要多少 ETH？

**总费用 = 资产价格 + Gas 费**

例如：
- 资产价格：1.5 ETH
- Gas 费：约 0.001-0.01 ETH
- 总计：约 1.501-1.51 ETH

**建议：**
- 确保账户余额 > 总费用
- 预留一些 ETH 用于后续操作

### Q4: 购买后多久能收到资产？

**时间线：**
1. **立即**：订单创建，状态变为"已支付"
2. **等待卖家**：卖家需要点击"发货"
3. **物流时间**：根据实际物流情况
4. **确认收货**：买家收到后点击"确认收货"
5. **完成交易**：资产所有权转移到买家

**链上操作：**
- 购买：立即完成（几秒到几分钟）
- 发货：卖家操作后立即生效
- 确认收货：买家操作后立即生效

### Q5: 如何申请退款？

**条件：**
- ✅ 订单状态为已支付/已发货/已送达
- ✅ 在退款期限内
- ✅ 卖家未完成交易

**步骤：**
1. 进入"我的订单"页面
2. 找到要退款的订单
3. 点击"申请退款"按钮
4. MetaMask 确认交易
5. 等待区块链确认
6. 退款成功，ETH 返回

**注意：**
- 退款需要支付少量 Gas 费
- 退款后订单状态变为"已退款"
- 资产所有权不会转移

### Q6: 地址显示不完整怎么办？

**解决方案：**
1. 点击资产的"查看详情"按钮
2. 在详情页面可以看到完整地址
3. 点击"📋 复制"按钮复制完整地址

**地址显示位置：**
- 卡片列表：缩略显示（`0xf39F...2266`）
- 详情页面：完整显示（`0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266`）

### Q7: 如何验证资产真实性？

**检查项：**
1. **验证状态**
   - ✅ 已验证：品牌方已验证
   - ⏳ 待验证：等待品牌方验证
   - ❌ 未验证：未经验证

2. **品牌地址**
   - 查看详情页面的品牌地址
   - 确认是否为官方品牌地址

3. **序列号**
   - 检查序列号格式
   - 与实物对比

4. **区块链记录**
   - 查看交易哈希
   - 在区块链浏览器验证

### Q8: 购买失败怎么办？

**常见原因：**
1. **余额不足**
   - 检查账户余额
   - 确保有足够的 ETH

2. **Gas 费不足**
   - 增加 Gas 费限额
   - 等待网络拥堵缓解

3. **资产已售出**
   - 刷新页面
   - 选择其他资产

4. **网络问题**
   - 检查网络连接
   - 重新连接 MetaMask

**解决步骤：**
1. 查看错误提示
2. 检查 MetaMask 交易记录
3. 刷新页面重试
4. 联系技术支持

---

## 8. 完整购买示例

### 场景：购买 Chanel 腰带

#### 卖家操作（已完成）
1. ✅ 注册资产：Chanel 腰带
2. ✅ 上架资产：价格 1.5 ETH
3. ✅ 等待买家

#### 买家操作（您要做的）

**步骤 1: 准备**
```
1. 打开 MetaMask
2. 切换到买家账户（例如账户 #1）
3. 检查余额：> 1.51 ETH
```

**步骤 2: 连接**
```
1. 访问 http://localhost:3000/index-native.html
2. 点击"连接钱包"
3. MetaMask 确认连接
4. 看到账户地址显示在右上角
```

**步骤 3: 浏览**
```
1. 默认显示"市场"页面
2. 看到"Chanel 腰带"卡片
3. 显示信息：
   - 名称：Chanel 腰带
   - 序列号：CHANEL-ITEM-20260112-4108
   - 价格：1.5 ETH
   - 状态：✅ 已验证
```

**步骤 4: 查看详情（可选）**
```
1. 点击"查看详情"按钮
2. 查看完整信息：
   - 完整的所有者地址
   - 完整的品牌地址
   - 完整的交易哈希
3. 点击"📋 复制"复制地址
4. 关闭详情页面
```

**步骤 5: 购买**
```
1. 点击"购买"按钮
2. MetaMask 弹出确认窗口
3. 检查：
   - 金额：1.5 ETH ✅
   - Gas 费：0.001 ETH ✅
   - 总计：1.501 ETH ✅
4. 点击"确认"
5. 等待确认（约 10 秒）
6. 看到提示：✅ 购买成功!
```

**步骤 6: 查看订单**
```
1. 点击"我的订单"标签
2. 看到新订单：
   - 订单 #1
   - 资产 ID: 2
   - 价格: 1.5 ETH
   - 状态: 已支付
3. 等待卖家发货
```

**步骤 7: 确认收货**
```
当卖家发货后：
1. 订单状态变为"已发货"
2. 收到实物商品
3. 点击"确认收货"按钮
4. MetaMask 确认
5. 订单状态变为"已送达"
```

**步骤 8: 完成交易**
```
1. 点击"完成交易"按钮
2. MetaMask 确认
3. 订单状态变为"已完成"
4. 资产所有权转移到您的账户
5. 在"我的资产"页面可以看到该资产
```

---

## 9. 快速参考

### 页面导航
- 🛒 **市场**：浏览所有在售资产
- 📦 **我的资产**：查看您拥有的资产
- 📋 **我的订单**：管理购买订单
- ➕ **注册资产**：注册新资产（卖家功能）

### 操作按钮
- **查看详情**：查看完整资产信息
- **购买**：购买在售资产
- **确认收货**：确认收到商品
- **完成交易**：完成交易流程
- **申请退款**：申请退款

### 状态说明
- ✅ **已验证**：品牌方已验证
- ⏳ **待验证**：等待验证
- ❌ **未验证**：未经验证

### 订单状态
- **已创建**：订单已创建
- **已支付**：买家已支付
- **已发货**：卖家已发货
- **已送达**：买家已确认收货
- **已完成**：交易完成
- **已退款**：已退款

---

## 10. 技术支持

### 遇到问题？

1. **查看文档**
   - `QUICK_START.md` - 快速启动
   - `NATIVE_UI_GUIDE.md` - 详细指南
   - `访问新UI.md` - 访问说明

2. **检查控制台**
   - 按 F12 打开开发者工具
   - 查看 Console 标签
   - 查看错误信息

3. **检查 MetaMask**
   - 查看交易记录
   - 检查网络连接
   - 确认账户余额

---

**祝您购物愉快！** 🛒✨

如有任何问题，请参考文档或联系技术支持。
