# ğŸ“ ChainVault V3 - Web3 æ–°æ‰‹å…¥é—¨æŒ‡å—

> ä»é›¶å¼€å§‹ç†è§£åŒºå—é“¾èµ„äº§äº¤æ˜“å¹³å°

---

## ğŸ“š ç›®å½•

1. [Web3 åŸºç¡€æ¦‚å¿µ](#web3-åŸºç¡€æ¦‚å¿µ)
2. [é¡¹ç›®æ¶æ„ç®€ä»‹](#é¡¹ç›®æ¶æ„ç®€ä»‹)
3. [æ ¸å¿ƒæ¦‚å¿µè§£é‡Š](#æ ¸å¿ƒæ¦‚å¿µè§£é‡Š)
4. [ä»£ç é€æ­¥è®²è§£](#ä»£ç é€æ­¥è®²è§£)
5. [å®æˆ˜æ¼”ç»ƒ](#å®æˆ˜æ¼”ç»ƒ)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸŒŸ Web3 åŸºç¡€æ¦‚å¿µ

### ä»€ä¹ˆæ˜¯ Web3ï¼Ÿ

**Web1.0**ï¼ˆåªè¯»ï¼‰ï¼š
```
ç”¨æˆ· â†’ é˜…è¯»ç½‘é¡µ
ä¾‹å¦‚ï¼šæ—©æœŸçš„æ–°é—»ç½‘ç«™ï¼Œåªèƒ½çœ‹ä¸èƒ½äº’åŠ¨
```

**Web2.0**ï¼ˆè¯»å†™ï¼‰ï¼š
```
ç”¨æˆ· â†” äº’åŠ¨ç½‘ç«™
ä¾‹å¦‚ï¼šå¾®ä¿¡ã€æ·˜å®ï¼Œå¯ä»¥å‘æ¶ˆæ¯ã€ä¹°ä¸œè¥¿
```

**Web3.0**ï¼ˆè¯»å†™æ‹¥æœ‰ï¼‰ï¼š
```
ç”¨æˆ· â†” å»ä¸­å¿ƒåŒ–åº”ç”¨ â†” åŒºå—é“¾
ä¾‹å¦‚ï¼šChainVaultï¼Œä½ çœŸæ­£æ‹¥æœ‰ä½ çš„æ•°æ®å’Œèµ„äº§
```

### Web3 çš„æ ¸å¿ƒç‰¹ç‚¹

1. **å»ä¸­å¿ƒåŒ–** - æ²¡æœ‰ä¸­å¿ƒæœåŠ¡å™¨ï¼Œæ•°æ®å­˜å‚¨åœ¨åŒºå—é“¾ä¸Š
2. **ä¸å¯ç¯¡æ”¹** - ä¸€æ—¦è®°å½•åˆ°åŒºå—é“¾ï¼Œæ— æ³•ä¿®æ”¹
3. **é€æ˜å¯è¿½æº¯** - æ‰€æœ‰äº¤æ˜“å…¬å¼€å¯æŸ¥
4. **ç”¨æˆ·æ‹¥æœ‰** - ä½ çš„èµ„äº§çœŸæ­£å±äºä½ 

---

## ğŸ—ï¸ é¡¹ç›®æ¶æ„ç®€ä»‹

### ChainVault æ˜¯ä»€ä¹ˆï¼Ÿ

æƒ³è±¡ä¸€ä¸‹ï¼š
- **æ·˜å®** = ä¸­å¿ƒåŒ–çš„äº¤æ˜“å¹³å°ï¼ˆå…¬å¸æ§åˆ¶ï¼‰
- **ChainVault** = å»ä¸­å¿ƒåŒ–çš„äº¤æ˜“å¹³å°ï¼ˆåŒºå—é“¾æ§åˆ¶ï¼‰

### ä¸‰å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ï¼ˆç½‘é¡µï¼‰                        â”‚
â”‚   - ä½ çœ‹åˆ°çš„ç•Œé¢                      â”‚
â”‚   - è¿æ¥é’±åŒ…ã€æ³¨å†Œèµ„äº§ã€è´­ä¹°å•†å“       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åç«¯ï¼ˆæœåŠ¡å™¨ï¼‰                      â”‚
â”‚   - æä¾› API æ¥å£                    â”‚
â”‚   - ç¼“å­˜æ•°æ®ï¼ŒåŠ å¿«æŸ¥è¯¢                â”‚
â”‚   - ç›‘å¬åŒºå—é“¾äº‹ä»¶                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ™ºèƒ½åˆçº¦ï¼ˆåŒºå—é“¾ï¼‰                  â”‚
â”‚   - å­˜å‚¨èµ„äº§ä¿¡æ¯                      â”‚
â”‚   - å¤„ç†äº¤æ˜“é€»è¾‘                      â”‚
â”‚   - æ‰˜ç®¡èµ„é‡‘                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µè§£é‡Š

### 1. é’±åŒ…ï¼ˆWalletï¼‰

**ç±»æ¯”**ï¼šé’±åŒ… = ä½ çš„é“¶è¡Œè´¦æˆ·

```
é’±åŒ…åœ°å€ï¼š0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
         â†‘
         ç±»ä¼¼äºä½ çš„é“¶è¡Œå¡å·ï¼Œåˆ«äººå¯ä»¥çœ‹åˆ°

ç§é’¥ï¼š0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
     â†‘
     ç±»ä¼¼äºä½ çš„é“¶è¡Œå¡å¯†ç ï¼Œç»å¯¹ä¸èƒ½å‘Šè¯‰åˆ«äººï¼
```

**é‡è¦**ï¼š
- âœ… é’±åŒ…åœ°å€å¯ä»¥å…¬å¼€ï¼ˆç”¨äºæ¥æ”¶èµ„äº§ï¼‰
- âŒ ç§é’¥ç»å¯¹ä¿å¯†ï¼ˆè°æœ‰ç§é’¥è°å°±æ‹¥æœ‰èµ„äº§ï¼‰

### 2. æ™ºèƒ½åˆçº¦ï¼ˆSmart Contractï¼‰

**ç±»æ¯”**ï¼šæ™ºèƒ½åˆçº¦ = è‡ªåŠ¨å”®è´§æœº

```
ä¼ ç»Ÿäº¤æ˜“ï¼ˆéœ€è¦ä¿¡ä»»ï¼‰ï¼š
ä¹°å®¶ â†’ ç»™é’± â†’ å–å®¶ â†’ å‘è´§ â†’ ä¹°å®¶
      â†‘ å¦‚æœå–å®¶ä¸å‘è´§æ€ä¹ˆåŠï¼Ÿ

æ™ºèƒ½åˆçº¦ï¼ˆä¸éœ€è¦ä¿¡ä»»ï¼‰ï¼š
ä¹°å®¶ â†’ ç»™é’± â†’ åˆçº¦æ‰˜ç®¡ â†’ å–å®¶å‘è´§ â†’ ä¹°å®¶ç¡®è®¤ â†’ åˆçº¦è‡ªåŠ¨æ”¯ä»˜
             â†‘ åˆçº¦è‡ªåŠ¨æ‰§è¡Œï¼Œæ— æ³•ä½œå¼Š
```

**ç‰¹ç‚¹**ï¼š
- ä»£ç å…¬å¼€é€æ˜
- è‡ªåŠ¨æ‰§è¡Œï¼Œä¸å¯ç¯¡æ”¹
- ä¸éœ€è¦ä¿¡ä»»ç¬¬ä¸‰æ–¹

### 3. Gas è´¹ç”¨

**ç±»æ¯”**ï¼šGas = é«˜é€Ÿå…¬è·¯è¿‡è·¯è´¹

```
ä½ åœ¨åŒºå—é“¾ä¸Šåšä»»ä½•æ“ä½œéƒ½éœ€è¦æ”¯ä»˜ Gas è´¹ç”¨ï¼š
- æ³¨å†Œèµ„äº§ï¼š~0.001 ETH
- è´­ä¹°å•†å“ï¼š~0.002 ETH
- è½¬ç§»èµ„äº§ï¼š~0.001 ETH

ä¸ºä»€ä¹ˆè¦ä»˜è´¹ï¼Ÿ
- çŸ¿å·¥éœ€è¦è®¡ç®—å’Œå­˜å‚¨ä½ çš„äº¤æ˜“
- é˜²æ­¢åƒåœ¾äº¤æ˜“ï¼ˆå¦‚æœå…è´¹ï¼Œæœ‰äººä¼šç–¯ç‹‚å‘äº¤æ˜“ï¼‰
```

### 4. äº‹ä»¶ï¼ˆEventï¼‰

**ç±»æ¯”**ï¼šäº‹ä»¶ = å¹¿æ’­é€šçŸ¥

```
å½“æœ‰äººæ³¨å†Œèµ„äº§æ—¶ï¼š
æ™ºèƒ½åˆçº¦ â†’ å‘å‡ºäº‹ä»¶ï¼š"æœ‰äººæ³¨å†Œäº†èµ„äº§ï¼"
         â†“
åç«¯ç›‘å¬å™¨ â†’ æ”¶åˆ°é€šçŸ¥ â†’ ä¿å­˜åˆ°æ•°æ®åº“
         â†“
å‰ç«¯ â†’ åˆ·æ–°é¡µé¢ â†’ æ˜¾ç¤ºæ–°èµ„äº§
```

**ç”¨é€”**ï¼š
- è®©å¤–éƒ¨ç¨‹åºçŸ¥é“åˆçº¦å‘ç”Ÿäº†ä»€ä¹ˆ
- ç”¨äºæ•°æ®åŒæ­¥
- æ¯”ç›´æ¥æŸ¥è¯¢åˆçº¦ä¾¿å®œï¼ˆä¸éœ€è¦ Gasï¼‰

### 5. IPFS

**ç±»æ¯”**ï¼šIPFS = å»ä¸­å¿ƒåŒ–çš„ç½‘ç›˜

```
ä¼ ç»Ÿå­˜å‚¨ï¼ˆä¸­å¿ƒåŒ–ï¼‰ï¼š
ç…§ç‰‡ â†’ ä¸Šä¼ åˆ°æœåŠ¡å™¨ â†’ å¾—åˆ°é“¾æ¥
      â†‘ å¦‚æœæœåŠ¡å™¨å…³é—­ï¼Œç…§ç‰‡å°±ä¸¢å¤±äº†

IPFSï¼ˆå»ä¸­å¿ƒåŒ–ï¼‰ï¼š
ç…§ç‰‡ â†’ ä¸Šä¼ åˆ° IPFS â†’ å¾—åˆ°å“ˆå¸Œå€¼ï¼ˆQmXxx...ï¼‰
      â†‘ ç…§ç‰‡åˆ†å¸ƒåœ¨å…¨çƒå¤šä¸ªèŠ‚ç‚¹ï¼Œæ°¸ä¸ä¸¢å¤±
```

**ä¸ºä»€ä¹ˆç”¨ IPFSï¼Ÿ**
- åŒºå—é“¾å­˜å‚¨å¾ˆè´µï¼ˆ1MB å¯èƒ½è¦å‡ ç™¾ç¾å…ƒï¼‰
- IPFS å­˜å‚¨ä¾¿å®œï¼ˆå‡ ä¹å…è´¹ï¼‰
- ç…§ç‰‡å­˜ IPFSï¼Œé“¾æ¥å­˜åŒºå—é“¾

---

## ğŸ” ä»£ç é€æ­¥è®²è§£

### ç¬¬ä¸€æ­¥ï¼šç†è§£æ™ºèƒ½åˆçº¦

#### æœ€ç®€å•çš„ä¾‹å­ï¼šæ³¨å†Œèµ„äº§

```solidity
// æ™ºèƒ½åˆçº¦ä»£ç ï¼ˆSolidity è¯­è¨€ï¼‰

// 1. å®šä¹‰èµ„äº§ç»“æ„ï¼ˆå°±åƒå®šä¹‰ä¸€ä¸ªè¡¨æ ¼ï¼‰
struct Asset {
    uint256 assetId;        // èµ„äº§IDï¼ˆæ•°å­—ï¼‰
    address owner;          // æ‰€æœ‰è€…åœ°å€
    string name;            // èµ„äº§åç§°
    string serialNumber;    // åºåˆ—å·
    uint256 createdAt;      // åˆ›å»ºæ—¶é—´
}

// 2. å­˜å‚¨èµ„äº§ï¼ˆå°±åƒä¸€ä¸ªå­—å…¸ï¼‰
mapping(uint256 => Asset) public assets;  // é€šè¿‡IDæŸ¥æ‰¾èµ„äº§
uint256 public assetCounter;              // èµ„äº§è®¡æ•°å™¨

// 3. æ³¨å†Œèµ„äº§å‡½æ•°
function registerAsset(string name, string serialNumber) external {
    // æ£€æŸ¥ï¼šåç§°ä¸èƒ½ä¸ºç©º
    require(bytes(name).length > 0, "Name cannot be empty");
    
    // æ£€æŸ¥ï¼šåºåˆ—å·ä¸èƒ½é‡å¤
    require(!serialNumberExists[serialNumber], "Serial number already exists");
    
    // åˆ›å»ºæ–°èµ„äº§
    assetCounter++;  // ID åŠ  1
    assets[assetCounter] = Asset({
        assetId: assetCounter,
        owner: msg.sender,      // msg.sender = è°ƒç”¨è€…çš„åœ°å€
        name: name,
        serialNumber: serialNumber,
        createdAt: block.timestamp  // block.timestamp = å½“å‰æ—¶é—´
    });
    
    // å‘å‡ºäº‹ä»¶ï¼ˆé€šçŸ¥å¤–ç•Œï¼‰
    emit AssetRegistered(assetCounter, msg.sender, name);
}
```

**è§£é‡Š**ï¼š
- `msg.sender` = è°è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ï¼ˆè‡ªåŠ¨è·å–ï¼‰
- `block.timestamp` = å½“å‰åŒºå—çš„æ—¶é—´æˆ³
- `require()` = æ£€æŸ¥æ¡ä»¶ï¼Œä¸æ»¡è¶³å°±å›é€€äº¤æ˜“
- `emit` = å‘å‡ºäº‹ä»¶ï¼Œè®©å¤–éƒ¨ç¨‹åºçŸ¥é“

#### ç¨å¾®å¤æ‚çš„ä¾‹å­ï¼šè´­ä¹°èµ„äº§

```solidity
// è´­ä¹°èµ„äº§å‡½æ•°
function createOrder(uint256 assetId) external payable {
    // payable = è¿™ä¸ªå‡½æ•°å¯ä»¥æ¥æ”¶ ETH
    
    Asset storage asset = assets[assetId];
    
    // æ£€æŸ¥1ï¼šèµ„äº§å¿…é¡»åœ¨å”®
    require(asset.isListed, "Asset not for sale");
    
    // æ£€æŸ¥2ï¼šä¸èƒ½ä¹°è‡ªå·±çš„
    require(asset.owner != msg.sender, "Cannot buy your own asset");
    
    // æ£€æŸ¥3ï¼šæ”¯ä»˜é‡‘é¢å¿…é¡»æ­£ç¡®
    require(msg.value == asset.price, "Incorrect payment amount");
    // msg.value = ç”¨æˆ·å‘é€çš„ ETH æ•°é‡
    
    // åˆ›å»ºè®¢å•
    orderCounter++;
    orders[orderCounter] = Order({
        orderId: orderCounter,
        assetId: assetId,
        seller: asset.owner,
        buyer: msg.sender,
        price: msg.value,
        status: OrderStatus.Paid  // çŠ¶æ€ï¼šå·²æ”¯ä»˜
    });
    
    // èµ„é‡‘ç°åœ¨æ‰˜ç®¡åœ¨åˆçº¦ä¸­ï¼
    // ç­‰å¾…å–å®¶å‘è´§ã€ä¹°å®¶ç¡®è®¤æ”¶è´§åï¼Œæ‰ä¼šæ”¯ä»˜ç»™å–å®¶
}
```

**å…³é”®ç‚¹**ï¼š
- `payable` = å‡½æ•°å¯ä»¥æ¥æ”¶ ETH
- `msg.value` = ç”¨æˆ·å‘é€çš„ ETH æ•°é‡
- èµ„é‡‘æ‰˜ç®¡åœ¨åˆçº¦ä¸­ï¼Œä¸æ˜¯ç«‹å³ç»™å–å®¶

### ç¬¬äºŒæ­¥ï¼šç†è§£åç«¯

#### åç«¯çš„ä½œç”¨

```
ä¸ºä»€ä¹ˆéœ€è¦åç«¯ï¼Ÿ

ç›´æ¥æŸ¥è¯¢åŒºå—é“¾ï¼š
ç”¨æˆ· â†’ æŸ¥è¯¢åˆçº¦ â†’ ç­‰å¾…3ç§’ â†’ å¾—åˆ°ç»“æœ
     â†‘ æ…¢ï¼Œéœ€è¦ Gas è´¹ç”¨

é€šè¿‡åç«¯æŸ¥è¯¢ï¼š
ç”¨æˆ· â†’ æŸ¥è¯¢åç«¯ â†’ 0.1ç§’ â†’ å¾—åˆ°ç»“æœ
     â†‘ å¿«ï¼Œå…è´¹
```

#### äº‹ä»¶ç›‘å¬å™¨

```go
// åç«¯ç›‘å¬å™¨ï¼ˆGo è¯­è¨€ï¼‰

// 1. è¿æ¥åˆ°åŒºå—é“¾
client, _ := ethers.Dial("http://localhost:8545")

// 2. ç›‘å¬äº‹ä»¶
for {
    // æ‰«ææ–°åŒºå—
    events := scanNewBlocks()
    
    // å¤„ç†äº‹ä»¶
    for _, event := range events {
        if event.Name == "AssetRegistered" {
            // ä¿å­˜åˆ°æ•°æ®åº“
            db.Create(&Asset{
                ID: event.AssetId,
                Owner: event.Owner,
                Name: event.Name,
                // ...
            })
        }
    }
    
    // ç­‰å¾…15ç§’ï¼ˆä¸€ä¸ªæ–°åŒºå—ï¼‰
    time.Sleep(15 * time.Second)
}
```

**æµç¨‹**ï¼š
1. ç”¨æˆ·åœ¨å‰ç«¯æ³¨å†Œèµ„äº§
2. äº¤æ˜“å‘é€åˆ°åŒºå—é“¾
3. æ™ºèƒ½åˆçº¦å‘å‡ºäº‹ä»¶
4. åç«¯ç›‘å¬å™¨æ”¶åˆ°äº‹ä»¶
5. ä¿å­˜åˆ°æ•°æ®åº“
6. å‰ç«¯æŸ¥è¯¢åç«¯ï¼Œæ˜¾ç¤ºæ–°èµ„äº§

### ç¬¬ä¸‰æ­¥ï¼šç†è§£å‰ç«¯

#### è¿æ¥é’±åŒ…

```typescript
// å‰ç«¯ä»£ç ï¼ˆTypeScriptï¼‰

// 1. æ£€æŸ¥ MetaMask æ˜¯å¦å®‰è£…
if (typeof window.ethereum !== 'undefined') {
    // window.ethereum = MetaMask æ³¨å…¥çš„å¯¹è±¡
    
    // 2. è¯·æ±‚è¿æ¥
    const provider = new ethers.BrowserProvider(window.ethereum);
    const accounts = await provider.send("eth_requestAccounts", []);
    
    // 3. è·å–ç”¨æˆ·åœ°å€
    const userAddress = accounts[0];
    console.log("ç”¨æˆ·åœ°å€:", userAddress);
    
} else {
    alert("è¯·å®‰è£… MetaMask!");
}
```

#### è°ƒç”¨åˆçº¦

```typescript
// è°ƒç”¨æ™ºèƒ½åˆçº¦å‡½æ•°

// 1. åˆ›å»ºåˆçº¦å®ä¾‹
const contract = new ethers.Contract(
    CONTRACT_ADDRESS,  // åˆçº¦åœ°å€
    ABI,               // åˆçº¦æ¥å£å®šä¹‰
    signer             // ç­¾åè€…ï¼ˆä½ çš„é’±åŒ…ï¼‰
);

// 2. è°ƒç”¨å‡½æ•°ï¼ˆè¯»å–æ•°æ®ï¼Œå…è´¹ï¼‰
const asset = await contract.assets(1);
console.log("èµ„äº§åç§°:", asset.name);

// 3. è°ƒç”¨å‡½æ•°ï¼ˆå†™å…¥æ•°æ®ï¼Œéœ€è¦ Gasï¼‰
const tx = await contract.registerAsset("Nike Shoes", "NK-001", "");
// tx = äº¤æ˜“å¯¹è±¡ï¼ŒåŒ…å«äº¤æ˜“å“ˆå¸Œ

// 4. ç­‰å¾…äº¤æ˜“ç¡®è®¤
await tx.wait();
console.log("æ³¨å†ŒæˆåŠŸï¼");
```

---

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µè§£é‡Š

### æ¦‚å¿µ 1ï¼šå“ç‰Œæˆæƒæœºåˆ¶

**é—®é¢˜**ï¼šå¦‚ä½•é˜²æ­¢æœ‰äººå‡å†’ Nike æ³¨å†Œå‡é‹ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼šä¸‰çº§æˆæƒ

```
ç¬¬ä¸€çº§ï¼šå¹³å°ç®¡ç†å‘˜
   â†“ å®¡æ ¸å¹¶æˆæƒ
ç¬¬äºŒçº§ï¼šå“ç‰Œæ–¹ï¼ˆNikeï¼‰
   â†“ æ³¨å†Œå•†å“
ç¬¬ä¸‰çº§ï¼šèµ„äº§ï¼ˆä¸€åŒé‹ï¼‰
```

**ä»£ç å®ç°**ï¼š

```solidity
// 1. ä»»ä½•äººéƒ½å¯ä»¥æ³¨å†Œä¸ºå“ç‰Œ
function registerBrand(string brandName) external {
    brands[msg.sender] = Brand({
        brandName: brandName,
        isAuthorized: false  // é»˜è®¤æœªæˆæƒ
    });
}

// 2. åªæœ‰ç®¡ç†å‘˜å¯ä»¥æˆæƒ
function authorizeBrand(address brandAddress, bool authorized) external {
    require(msg.sender == admin, "Only admin");  // å¿…é¡»æ˜¯ç®¡ç†å‘˜
    brands[brandAddress].isAuthorized = authorized;
}

// 3. åªæœ‰æˆæƒå“ç‰Œå¯ä»¥æ‰¹é‡æ³¨å†Œèµ„äº§
function registerAsset(...) external {
    require(brands[msg.sender].isAuthorized, "Not authorized");  // å¿…é¡»æ˜¯æˆæƒå“ç‰Œ
    // æ³¨å†Œèµ„äº§...
}
```

**æµç¨‹å›¾**ï¼š

```
Nike å…¬å¸ï¼š
1. è°ƒç”¨ registerBrand("Nike")
   â†’ çŠ¶æ€ï¼šæœªæˆæƒ

2. å¹³å°å®¡æ ¸ï¼ˆçº¿ä¸‹éªŒè¯è¥ä¸šæ‰§ç…§ï¼‰
   â†’ ç®¡ç†å‘˜è°ƒç”¨ authorizeBrand(Nikeåœ°å€, true)
   â†’ çŠ¶æ€ï¼šå·²æˆæƒ

3. Nike å¯ä»¥æ‰¹é‡æ³¨å†Œå•†å“
   â†’ è°ƒç”¨ registerAsset("Air Jordan 1", "NK-001", ...)
   â†’ è‡ªåŠ¨éªŒè¯ä¸ºçœŸå“
```

### æ¦‚å¿µ 2ï¼šåºåˆ—å·å”¯ä¸€æ€§

**é—®é¢˜**ï¼šå¼ ä¸‰ã€æå››ã€ç‹äº”éƒ½æœ‰ä¸€åŒ Air Jordanï¼Œå¦‚ä½•åŒºåˆ†ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼šæ¯åŒé‹éƒ½æœ‰å”¯ä¸€çš„åºåˆ—å·

```
å¼ ä¸‰çš„é‹ï¼š
- åºåˆ—å·ï¼šNK-AJ1-2024-001
- æ‰€æœ‰è€…ï¼š0x123...ï¼ˆå¼ ä¸‰çš„é’±åŒ…åœ°å€ï¼‰

æå››çš„é‹ï¼š
- åºåˆ—å·ï¼šNK-AJ1-2024-002
- æ‰€æœ‰è€…ï¼š0x456...ï¼ˆæå››çš„é’±åŒ…åœ°å€ï¼‰

ç‹äº”çš„é‹ï¼š
- åºåˆ—å·ï¼šNK-AJ1-2024-003
- æ‰€æœ‰è€…ï¼š0x789...ï¼ˆç‹äº”çš„é’±åŒ…åœ°å€ï¼‰
```

**ä»£ç å®ç°**ï¼š

```solidity
// åºåˆ—å·æ˜ å°„
mapping(string => bool) public serialNumberExists;
mapping(string => uint256) public serialNumberToAssetId;

function registerAsset(..., string serialNumber, ...) {
    // æ£€æŸ¥åºåˆ—å·æ˜¯å¦å·²å­˜åœ¨
    require(!serialNumberExists[serialNumber], "Serial number already exists");
    
    // æ ‡è®°åºåˆ—å·å·²ä½¿ç”¨
    serialNumberExists[serialNumber] = true;
    
    // å»ºç«‹åºåˆ—å·åˆ°èµ„äº§IDçš„æ˜ å°„
    serialNumberToAssetId[serialNumber] = assetCounter;
}

// é€šè¿‡åºåˆ—å·æŸ¥è¯¢èµ„äº§
function getAssetBySerialNumber(string serialNumber) external view returns (Asset) {
    uint256 assetId = serialNumberToAssetId[serialNumber];
    return assets[assetId];
}
```

**å®é™…åº”ç”¨**ï¼š

```
ç”¨æˆ·æ‰«æé‹å­ä¸Šçš„ NFC æ ‡ç­¾ï¼š
1. è¯»å–åºåˆ—å·ï¼šNK-AJ1-2024-001
2. æŸ¥è¯¢åŒºå—é“¾ï¼šgetAssetBySerialNumber("NK-AJ1-2024-001")
3. æ˜¾ç¤ºç»“æœï¼š
   - å“ç‰Œï¼šNikeï¼ˆå·²æˆæƒ âœ…ï¼‰
   - æ‰€æœ‰è€…ï¼šå¼ ä¸‰ï¼ˆ0x123...ï¼‰
   - éªŒè¯çŠ¶æ€ï¼šå·²éªŒè¯ âœ…
   - æ³¨å†Œæ—¶é—´ï¼š2024-01-15
   - æ‰€æœ‰æƒå†å²ï¼šNike â†’ å¼ ä¸‰
4. ç»“è®ºï¼šè¿™æ˜¯çœŸé‹ï¼Œå±äºå¼ ä¸‰
```

### æ¦‚å¿µ 3ï¼šæ‰˜ç®¡æœºåˆ¶

**é—®é¢˜**ï¼šå¦‚ä½•ä¿è¯ä¹°å®¶ä»˜é’±åï¼Œå–å®¶ä¸€å®šå‘è´§ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼šèµ„é‡‘æ‰˜ç®¡

```
ä¼ ç»Ÿäº¤æ˜“ï¼ˆæœ‰é£é™©ï¼‰ï¼š
ä¹°å®¶ â†’ ç›´æ¥ç»™é’± â†’ å–å®¶
                   â†“ å¦‚æœå–å®¶ä¸å‘è´§ï¼Ÿ
                   ä¹°å®¶æŸå¤±

æ‰˜ç®¡äº¤æ˜“ï¼ˆå®‰å…¨ï¼‰ï¼š
ä¹°å®¶ â†’ ç»™é’± â†’ åˆçº¦æ‰˜ç®¡ â†’ å–å®¶å‘è´§ â†’ ä¹°å®¶ç¡®è®¤ â†’ åˆçº¦è‡ªåŠ¨æ”¯ä»˜
             â†‘ èµ„é‡‘é”å®š        â†‘ å¦‚æœä¸å‘è´§ï¼Ÿ
             åœ¨åˆçº¦ä¸­          ä¹°å®¶å¯ä»¥é€€æ¬¾
```

**ä»£ç å®ç°**ï¼š

```solidity
// 1. ä¹°å®¶ä¸‹å•ï¼ˆèµ„é‡‘æ‰˜ç®¡ï¼‰
function createOrder(uint256 assetId) external payable {
    require(msg.value == asset.price, "Incorrect payment");
    
    // åˆ›å»ºè®¢å•ï¼Œèµ„é‡‘ç•™åœ¨åˆçº¦ä¸­
    orders[orderCounter] = Order({
        buyer: msg.sender,
        seller: asset.owner,
        price: msg.value,  // èµ„é‡‘æ‰˜ç®¡åœ¨è¿™é‡Œï¼
        status: OrderStatus.Paid
    });
}

// 2. å–å®¶å‘è´§
function shipOrder(uint256 orderId) external {
    require(order.seller == msg.sender, "Not the seller");
    order.status = OrderStatus.Shipped;
}

// 3. ä¹°å®¶ç¡®è®¤æ”¶è´§
function confirmDelivery(uint256 orderId) external {
    require(order.buyer == msg.sender, "Not the buyer");
    order.status = OrderStatus.Delivered;
}

// 4. å®Œæˆäº¤æ˜“ï¼ˆæ”¯ä»˜ç»™å–å®¶ï¼‰
function completeOrder(uint256 orderId) external {
    // è®¡ç®—æ‰‹ç»­è´¹
    uint256 platformFee = order.price * 2 / 100;  // 2%
    uint256 sellerAmount = order.price - platformFee;
    
    // è½¬ç§»èµ„äº§æ‰€æœ‰æƒ
    asset.owner = order.buyer;
    
    // æ”¯ä»˜ç»™å–å®¶
    payable(order.seller).transfer(sellerAmount);
    // ç°åœ¨å–å®¶æ‰æ”¶åˆ°é’±ï¼
}
```

**æ—¶é—´çº¿**ï¼š

```
Day 1: ä¹°å®¶ä¸‹å•ï¼Œæ”¯ä»˜ 1 ETH
       â†’ 1 ETH é”å®šåœ¨åˆçº¦ä¸­
       
Day 2: å–å®¶å‘è´§
       â†’ èµ„é‡‘ä»åœ¨åˆçº¦ä¸­
       
Day 5: ä¹°å®¶ç¡®è®¤æ”¶è´§
       â†’ èµ„é‡‘ä»åœ¨åˆçº¦ä¸­ï¼Œå¼€å§‹3å¤©é€€è´§æœŸ
       
Day 8: å®Œæˆäº¤æ˜“
       â†’ å–å®¶æ”¶åˆ° 0.98 ETHï¼ˆæ‰£é™¤2%æ‰‹ç»­è´¹ï¼‰
       â†’ å¹³å°æ”¶åˆ° 0.02 ETH
       â†’ èµ„äº§æ‰€æœ‰æƒè½¬ç§»ç»™ä¹°å®¶
```

### æ¦‚å¿µ 4ï¼šé€€è´§æœºåˆ¶

**é—®é¢˜**ï¼šä¹°å®¶æ”¶åˆ°å•†å“åä¸æ»¡æ„ï¼Œèƒ½é€€è´§å—ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼šæ—¶é—´é™åˆ¶çš„é€€è´§

```solidity
struct Order {
    bool canRefund;           // æ˜¯å¦å¯ä»¥é€€æ¬¾
    uint256 refundDeadline;   // é€€æ¬¾æˆªæ­¢æ—¶é—´
}

// åˆ›å»ºè®¢å•æ—¶è®¾ç½®é€€è´§æœŸ
function createOrder(uint256 assetId) external payable {
    orders[orderCounter] = Order({
        // ...
        canRefund: true,
        refundDeadline: block.timestamp + 7 days  // 7å¤©åè¿‡æœŸ
    });
}

// ç”³è¯·é€€æ¬¾
function requestRefund(uint256 orderId) external {
    Order storage order = orders[orderId];
    
    // æ£€æŸ¥1ï¼šå¿…é¡»æ˜¯ä¹°å®¶
    require(order.buyer == msg.sender, "Not the buyer");
    
    // æ£€æŸ¥2ï¼šå¿…é¡»åœ¨é€€è´§æœŸå†…
    require(block.timestamp <= order.refundDeadline, "Deadline passed");
    
    // æ£€æŸ¥3ï¼šå¿…é¡»å…è®¸é€€æ¬¾
    require(order.canRefund, "Refund not allowed");
    
    // è®¡ç®—é€€æ¬¾é‡‘é¢ï¼ˆæ‰£é™¤2%æ‰‹ç»­è´¹ï¼‰
    uint256 refundFee = order.price * 2 / 100;
    uint256 refundAmount = order.price - refundFee;
    
    // é€€æ¬¾ç»™ä¹°å®¶
    payable(order.buyer).transfer(refundAmount);
    
    // èµ„äº§é‡æ–°ä¸Šæ¶
    assets[order.assetId].isListed = true;
}
```

**é€€è´§è§„åˆ™**ï¼š

| è®¢å•çŠ¶æ€ | é€€è´§æœŸé™ | æ‰£è´¹ |
|---------|---------|------|
| å·²æ”¯ä»˜ | 7å¤© | 2% |
| å·²å‘è´§ | 7å¤© | 2% |
| å·²é€è¾¾ | 3å¤© | 2% |
| å·²å®Œæˆ | ä¸å¯é€€ | - |

### æ¦‚å¿µ 5ï¼šç”Ÿå‘½å‘¨æœŸè¿½è¸ª

**é—®é¢˜**ï¼šå¦‚ä½•çŸ¥é“ä¸€åŒé‹ç»å†äº†å“ªäº›äº¤æ˜“ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼šè®°å½•æ‰€æœ‰å†å²

```solidity
// è®°å½•æ‰€æœ‰æƒå†å²
mapping(uint256 => address[]) public assetOwnerHistory;

// è®°å½•äº¤æ˜“å†å²
mapping(uint256 => uint256[]) public assetOrderHistory;

// æ¯æ¬¡è½¬ç§»æ‰€æœ‰æƒæ—¶è®°å½•
function transferAsset(uint256 assetId, address newOwner) external {
    asset.owner = newOwner;
    assetOwnerHistory[assetId].push(newOwner);  // æ·»åŠ åˆ°å†å²
}

// æ¯æ¬¡åˆ›å»ºè®¢å•æ—¶è®°å½•
function createOrder(uint256 assetId) external payable {
    // ...
    assetOrderHistory[assetId].push(orderCounter);  // æ·»åŠ åˆ°å†å²
}

// æŸ¥è¯¢å†å²
function getAssetOwnerHistory(uint256 assetId) external view returns (address[]) {
    return assetOwnerHistory[assetId];
}
```

**æŸ¥è¯¢ç¤ºä¾‹**ï¼š

```javascript
// æŸ¥è¯¢èµ„äº§ #1 çš„æ‰€æœ‰æƒå†å²
const history = await contract.getAssetOwnerHistory(1);

// ç»“æœï¼š
[
  "0x111...",  // Nike å…¬å¸
  "0x222...",  // ç¬¬ä¸€ä»»ä¸»äººï¼ˆå¼ ä¸‰ï¼‰
  "0x333...",  // ç¬¬äºŒä»»ä¸»äººï¼ˆæå››ï¼‰
  "0x444..."   // å½“å‰ä¸»äººï¼ˆç‹äº”ï¼‰
]

// è§£é‡Šï¼š
// è¿™åŒé‹ä» Nike ç”Ÿäº§ï¼Œå–ç»™å¼ ä¸‰ï¼Œå¼ ä¸‰å–ç»™æå››ï¼Œæå››å–ç»™ç‹äº”
```

---

## ğŸ® å®æˆ˜æ¼”ç»ƒ

### æ¼”ç»ƒ 1ï¼šæ³¨å†Œä½ çš„ç¬¬ä¸€ä¸ªèµ„äº§

#### æ­¥éª¤ 1ï¼šå¯åŠ¨é¡¹ç›®

```bash
cd chain-vault
./start-v3.sh
# é€‰æ‹© 1ï¼ˆå®Œæ•´éƒ¨ç½²ï¼‰
```

#### æ­¥éª¤ 2ï¼šè¿æ¥é’±åŒ…

1. æ‰“å¼€æµè§ˆå™¨ï¼šhttp://localhost:5173
2. ç‚¹å‡»"è¿æ¥é’±åŒ…"
3. MetaMask å¼¹å‡ºï¼Œç‚¹å‡»"è¿æ¥"
4. çœ‹åˆ°ä½ çš„åœ°å€ï¼š0xf39F...

#### æ­¥éª¤ 3ï¼šæ³¨å†Œèµ„äº§

1. ç‚¹å‡»"â• æ³¨å†Œèµ„äº§"æ ‡ç­¾
2. å¡«å†™ä¿¡æ¯ï¼š
   ```
   èµ„äº§åç§°ï¼šæˆ‘çš„ç¬¬ä¸€ä¸ª NFT
   åºåˆ—å·ï¼šTEST-001
   å…ƒæ•°æ® URIï¼šï¼ˆç•™ç©ºï¼‰
   ```
3. ç‚¹å‡»"æ³¨å†Œèµ„äº§"
4. MetaMask å¼¹å‡ºï¼Œç‚¹å‡»"ç¡®è®¤"
5. ç­‰å¾…å‡ ç§’ï¼Œçœ‹åˆ°"æ³¨å†ŒæˆåŠŸï¼"

#### æ­¥éª¤ 4ï¼šæŸ¥çœ‹èµ„äº§

1. ç‚¹å‡»"ğŸ“¦ æˆ‘çš„èµ„äº§"æ ‡ç­¾
2. çœ‹åˆ°åˆšæ³¨å†Œçš„èµ„äº§
3. æ˜¾ç¤ºï¼š
   - åç§°ï¼šæˆ‘çš„ç¬¬ä¸€ä¸ª NFT
   - åºåˆ—å·ï¼šTEST-001
   - æ‰€æœ‰è€…ï¼š0xf39F...ï¼ˆä½ çš„åœ°å€ï¼‰
   - çŠ¶æ€ï¼šå¾…éªŒè¯ï¼ˆå› ä¸ºä½ ä¸æ˜¯å“ç‰Œæ–¹ï¼‰

**æ­å–œï¼ä½ å·²ç»åœ¨åŒºå—é“¾ä¸Šæ³¨å†Œäº†ç¬¬ä¸€ä¸ªèµ„äº§ï¼** ğŸ‰

### æ¼”ç»ƒ 2ï¼šå®Œæ•´çš„ä¹°å–æµç¨‹

#### å‡†å¤‡å·¥ä½œï¼šåˆ‡æ¢è´¦æˆ·

```
MetaMask ä¸­æœ‰å¤šä¸ªè´¦æˆ·ï¼š
- Account #0: 0xf39F...ï¼ˆå–å®¶ï¼‰
- Account #1: 0x7099...ï¼ˆä¹°å®¶ï¼‰

åˆ‡æ¢æ–¹æ³•ï¼š
ç‚¹å‡» MetaMask é¡¶éƒ¨çš„è´¦æˆ·å â†’ é€‰æ‹©å¦ä¸€ä¸ªè´¦æˆ·
```

#### åœºæ™¯ï¼šå–å®¶ä¸Šæ¶å•†å“

```
ä½¿ç”¨ Account #0ï¼ˆå–å®¶ï¼‰

1. ç‚¹å‡»"ğŸ“¦ æˆ‘çš„èµ„äº§"
2. æ‰¾åˆ°èµ„äº§ #1
3. ç‚¹å‡»"ä¸Šæ¶"æŒ‰é’®
4. è¾“å…¥ä»·æ ¼ï¼š0.5ï¼ˆè¡¨ç¤º 0.5 ETHï¼‰
5. ç¡®è®¤äº¤æ˜“
6. ä¸Šæ¶æˆåŠŸï¼
```

#### åœºæ™¯ï¼šä¹°å®¶è´­ä¹°å•†å“

```
åˆ‡æ¢åˆ° Account #1ï¼ˆä¹°å®¶ï¼‰

1. ç‚¹å‡»"ğŸ›’ å¸‚åœº"æ ‡ç­¾
2. çœ‹åˆ°å–å®¶ä¸Šæ¶çš„å•†å“
3. ç‚¹å‡»"è´­ä¹°"æŒ‰é’®
4. MetaMask å¼¹å‡ºï¼Œæ˜¾ç¤ºéœ€è¦æ”¯ä»˜ 0.5 ETH
5. ç¡®è®¤æ”¯ä»˜
6. è´­ä¹°æˆåŠŸï¼
   â†’ 0.5 ETH ä»ä¹°å®¶è´¦æˆ·è½¬å‡º
   â†’ èµ„é‡‘æ‰˜ç®¡åœ¨åˆçº¦ä¸­
   â†’ èµ„äº§è‡ªåŠ¨ä¸‹æ¶
```

#### åœºæ™¯ï¼šå–å®¶å‘è´§

```
åˆ‡æ¢å› Account #0ï¼ˆå–å®¶ï¼‰

1. ç‚¹å‡»"ğŸ“‹ æˆ‘çš„è®¢å•"æ ‡ç­¾
2. çœ‹åˆ°æ–°è®¢å•ï¼ŒçŠ¶æ€ï¼šå·²æ”¯ä»˜
3. ç‚¹å‡»"å‘è´§"æŒ‰é’®
4. ç¡®è®¤äº¤æ˜“
5. è®¢å•çŠ¶æ€å˜ä¸ºï¼šå·²å‘è´§
```

#### åœºæ™¯ï¼šä¹°å®¶ç¡®è®¤æ”¶è´§

```
åˆ‡æ¢åˆ° Account #1ï¼ˆä¹°å®¶ï¼‰

1. ç‚¹å‡»"ğŸ“‹ æˆ‘çš„è®¢å•"æ ‡ç­¾
2. çœ‹åˆ°è®¢å•ï¼ŒçŠ¶æ€ï¼šå·²å‘è´§
3. ç‚¹å‡»"ç¡®è®¤æ”¶è´§"æŒ‰é’®
4. ç¡®è®¤äº¤æ˜“
5. è®¢å•çŠ¶æ€å˜ä¸ºï¼šå·²é€è¾¾
6. å¼€å§‹3å¤©é€€è´§æœŸ
```

#### åœºæ™¯ï¼šå®Œæˆäº¤æ˜“

```
3å¤©åï¼Œä»»ä¸€æ–¹éƒ½å¯ä»¥å®Œæˆäº¤æ˜“

1. ç‚¹å‡»"å®Œæˆäº¤æ˜“"æŒ‰é’®
2. ç¡®è®¤äº¤æ˜“
3. äº¤æ˜“å®Œæˆï¼
   â†’ å–å®¶æ”¶åˆ° 0.49 ETHï¼ˆ0.5 - 2%æ‰‹ç»­è´¹ï¼‰
   â†’ å¹³å°æ”¶åˆ° 0.01 ETH
   â†’ èµ„äº§æ‰€æœ‰æƒè½¬ç§»ç»™ä¹°å®¶
```

**æŸ¥çœ‹ç»“æœ**ï¼š

```
ä¹°å®¶æŸ¥çœ‹"ğŸ“¦ æˆ‘çš„èµ„äº§"ï¼š
â†’ çœ‹åˆ°èµ„äº§ #1ï¼Œæ‰€æœ‰è€…å˜æˆäº†ä¹°å®¶åœ°å€

å–å®¶æŸ¥çœ‹ä½™é¢ï¼š
â†’ å¢åŠ äº† 0.49 ETH
```

---

## ğŸ” ä»£ç è¯¦ç»†è®²è§£

### è®²è§£ 1ï¼šå¦‚ä½•è¯»å–åˆçº¦æ•°æ®

```typescript
// å‰ç«¯ä»£ç 

// 1. åˆ›å»ºåªè¯»çš„ Providerï¼ˆä¸éœ€è¦ç­¾åï¼‰
const provider = new ethers.BrowserProvider(window.ethereum);

// 2. åˆ›å»ºåˆçº¦å®ä¾‹ï¼ˆåªè¯»ï¼‰
const contract = new ethers.Contract(
    CONTRACT_ADDRESS,
    ABI,
    provider  // åªè¯»ï¼Œä¸éœ€è¦ signer
);

// 3. è¯»å–æ•°æ®ï¼ˆå…è´¹ï¼Œä¸éœ€è¦ Gasï¼‰
const totalAssets = await contract.assetCounter();
console.log("æ€»èµ„äº§æ•°:", totalAssets.toString());

const asset = await contract.assets(1);
console.log("èµ„äº§ #1:", {
    åç§°: asset.name,
    æ‰€æœ‰è€…: asset.owner,
    åºåˆ—å·: asset.serialNumber
});

// 4. æŸ¥è¯¢æ˜¯å¦æ˜¯å“ç‰Œæ–¹
const brandInfo = await contract.brands(myAddress);
console.log("æ˜¯å¦æ˜¯æˆæƒå“ç‰Œ:", brandInfo.isAuthorized);
```

**å…³é”®ç‚¹**ï¼š
- è¯»å–æ•°æ®ä¸éœ€è¦ Gas è´¹ç”¨
- ä¸éœ€è¦ MetaMask ç¡®è®¤
- ä½¿ç”¨ `provider`ï¼Œä¸éœ€è¦ `signer`

### è®²è§£ 2ï¼šå¦‚ä½•å†™å…¥åˆçº¦æ•°æ®

```typescript
// å‰ç«¯ä»£ç 

// 1. åˆ›å»ºå¯å†™çš„ Signerï¼ˆéœ€è¦ç­¾åï¼‰
const provider = new ethers.BrowserProvider(window.ethereum);
const signer = await provider.getSigner();

// 2. åˆ›å»ºåˆçº¦å®ä¾‹ï¼ˆå¯å†™ï¼‰
const contract = new ethers.Contract(
    CONTRACT_ADDRESS,
    ABI,
    signer  // å¯å†™ï¼Œéœ€è¦ signer
);

// 3. å†™å…¥æ•°æ®ï¼ˆéœ€è¦ Gasï¼Œéœ€è¦ç¡®è®¤ï¼‰
const tx = await contract.registerAsset(
    "Nike Air Jordan 1",
    "NK-AJ1-001",
    "ipfs://QmXxx..."
);

// tx = äº¤æ˜“å¯¹è±¡
console.log("äº¤æ˜“å“ˆå¸Œ:", tx.hash);

// 4. ç­‰å¾…äº¤æ˜“è¢«æ‰“åŒ…ï¼ˆçº¦15ç§’ï¼‰
const receipt = await tx.wait();
console.log("äº¤æ˜“å·²ç¡®è®¤ï¼ŒåŒºå—å·:", receipt.blockNumber);
```

**å…³é”®ç‚¹**ï¼š
- å†™å…¥æ•°æ®éœ€è¦ Gas è´¹ç”¨
- éœ€è¦ MetaMask ç¡®è®¤
- éœ€è¦ç­‰å¾…äº¤æ˜“è¢«æ‰“åŒ…
- ä½¿ç”¨ `signer`ï¼Œä¸æ˜¯ `provider`

### è®²è§£ 3ï¼šå¦‚ä½•å‘é€ ETH

```typescript
// è´­ä¹°èµ„äº§ï¼ˆéœ€è¦å‘é€ ETHï¼‰

// 1. æŸ¥è¯¢èµ„äº§ä»·æ ¼
const asset = await contract.assets(assetId);
const price = asset.price;  // ä»·æ ¼ï¼ˆweiï¼‰

// 2. è°ƒç”¨å‡½æ•°å¹¶å‘é€ ETH
const tx = await contract.createOrder(assetId, {
    value: price  // å‘é€çš„ ETH æ•°é‡
});

// 3. ç­‰å¾…ç¡®è®¤
await tx.wait();
console.log("è´­ä¹°æˆåŠŸï¼");
```

**å•ä½è½¬æ¢**ï¼š

```javascript
// ETH å’Œ wei çš„è½¬æ¢
// 1 ETH = 1,000,000,000,000,000,000 wei (10^18)

// ETH â†’ wei
const priceWei = ethers.parseEther("0.5");
// 0.5 ETH = 500000000000000000 wei

// wei â†’ ETH
const priceEth = ethers.formatEther("500000000000000000");
// 500000000000000000 wei = 0.5 ETH
```

---

## ğŸ¤” å¸¸è§é—®é¢˜

### Q1: åŒºå—é“¾å’Œæ•°æ®åº“æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**A**: 

| ç‰¹æ€§ | æ•°æ®åº“ | åŒºå—é“¾ |
|------|--------|--------|
| å­˜å‚¨ä½ç½® | ä¸­å¿ƒæœåŠ¡å™¨ | åˆ†å¸ƒå¼èŠ‚ç‚¹ |
| å¯ä»¥ä¿®æ”¹ | âœ… å¯ä»¥ | âŒ ä¸å¯ä»¥ |
| è°æ§åˆ¶ | å…¬å¸ | æ‰€æœ‰äºº |
| é€Ÿåº¦ | å¿«ï¼ˆæ¯«ç§’ï¼‰ | æ…¢ï¼ˆç§’ï¼‰ |
| æˆæœ¬ | ä¾¿å®œ | è´µ |

**ChainVault çš„æ–¹æ¡ˆ**ï¼š
- é‡è¦æ•°æ®å­˜åŒºå—é“¾ï¼ˆèµ„äº§æ‰€æœ‰æƒã€äº¤æ˜“è®°å½•ï¼‰
- æŸ¥è¯¢æ•°æ®ç”¨æ•°æ®åº“ï¼ˆå¿«é€Ÿã€ä¾¿å®œï¼‰
- ä¸¤è€…åŒæ­¥ï¼ˆäº‹ä»¶ç›‘å¬å™¨ï¼‰

### Q2: ä¸ºä»€ä¹ˆéœ€è¦åç«¯ï¼Ÿç›´æ¥ç”¨åŒºå—é“¾ä¸è¡Œå—ï¼Ÿ

**A**: å¯ä»¥ï¼Œä½†æœ‰ç¼ºç‚¹

```
åªç”¨åŒºå—é“¾ï¼š
- æŸ¥è¯¢æ…¢ï¼ˆæ¯æ¬¡æŸ¥è¯¢3ç§’ï¼‰
- ä¸èƒ½æœç´¢ï¼ˆåŒºå—é“¾ä¸æ”¯æŒæ¨¡ç³Šæœç´¢ï¼‰
- ä¸èƒ½æ’åºï¼ˆéœ€è¦éå†æ‰€æœ‰æ•°æ®ï¼‰
- ä¸èƒ½ç»Ÿè®¡ï¼ˆéœ€è¦è®¡ç®—æ‰€æœ‰æ•°æ®ï¼‰

åŠ ä¸Šåç«¯ï¼š
- æŸ¥è¯¢å¿«ï¼ˆæ¯«ç§’çº§ï¼‰
- æ”¯æŒæœç´¢ï¼ˆSQL LIKEï¼‰
- æ”¯æŒæ’åºï¼ˆORDER BYï¼‰
- æ”¯æŒç»Ÿè®¡ï¼ˆCOUNT, SUMï¼‰
```

### Q3: ä»€ä¹ˆæ˜¯ Gasï¼Œä¸ºä»€ä¹ˆè¦ä»˜è´¹ï¼Ÿ

**A**: Gas = è®¡ç®—è´¹ç”¨

```
ç±»æ¯”ï¼š
- ä½ å»é¥­åº—åƒé¥­ â†’ éœ€è¦ä»˜é’±
- ä½ ç”¨åŒºå—é“¾ â†’ éœ€è¦ä»˜ Gas

ä¸ºä»€ä¹ˆï¼Ÿ
- çŸ¿å·¥éœ€è¦è®¡ç®—ä½ çš„äº¤æ˜“
- çŸ¿å·¥éœ€è¦å­˜å‚¨ä½ çš„æ•°æ®
- é˜²æ­¢åƒåœ¾äº¤æ˜“ï¼ˆå¦‚æœå…è´¹ï¼Œæœ‰äººä¼šå‘é€æ— æ•°äº¤æ˜“ï¼‰

Gas è´¹ç”¨å–å†³äºï¼š
- æ“ä½œå¤æ‚åº¦ï¼ˆç®€å•æ“ä½œä¾¿å®œï¼Œå¤æ‚æ“ä½œè´µï¼‰
- ç½‘ç»œæ‹¥å µç¨‹åº¦ï¼ˆæ‹¥å µæ—¶è´µï¼Œç©ºé—²æ—¶ä¾¿å®œï¼‰
```

### Q4: ä»€ä¹ˆæ˜¯ ABIï¼Ÿ

**A**: ABI = åˆçº¦çš„"è¯´æ˜ä¹¦"

```
ç±»æ¯”ï¼š
- ä½ ä¹°äº†ä¸€ä¸ªé¥æ§å™¨
- è¯´æ˜ä¹¦å‘Šè¯‰ä½ ï¼šæŒ‰å“ªä¸ªæŒ‰é’®åšä»€ä¹ˆ
- ABI å‘Šè¯‰ç¨‹åºï¼šè°ƒç”¨å“ªä¸ªå‡½æ•°åšä»€ä¹ˆ

ABI ç¤ºä¾‹ï¼š
[
  "function registerAsset(string name, string serialNumber)",
  "function getAsset(uint256 id) view returns (address owner, string name)"
]

è§£é‡Šï¼š
- registerAssetï¼šéœ€è¦2ä¸ªå‚æ•°ï¼ˆname, serialNumberï¼‰
- getAssetï¼šéœ€è¦1ä¸ªå‚æ•°ï¼ˆidï¼‰ï¼Œè¿”å›ï¼ˆowner, nameï¼‰
```

### Q5: ä»€ä¹ˆæ˜¯äº‹ä»¶ï¼ˆEventï¼‰ï¼Ÿ

**A**: äº‹ä»¶ = åˆçº¦å‘å‡ºçš„é€šçŸ¥

```
ç±»æ¯”ï¼š
- ä½ åœ¨æ·˜å®ä¹°ä¸œè¥¿
- å–å®¶å‘è´§åï¼Œæ·˜å®å‘çŸ­ä¿¡é€šçŸ¥ä½ 
- æ™ºèƒ½åˆçº¦å‘å‡ºäº‹ä»¶ï¼Œé€šçŸ¥å¤–éƒ¨ç¨‹åº

ä»£ç ï¼š
// å®šä¹‰äº‹ä»¶
event AssetRegistered(uint256 assetId, address owner, string name);

// å‘å‡ºäº‹ä»¶
emit AssetRegistered(1, msg.sender, "Nike Shoes");

// åç«¯ç›‘å¬äº‹ä»¶
eventListener.on("AssetRegistered", (assetId, owner, name) => {
    console.log("æœ‰äººæ³¨å†Œäº†èµ„äº§:", name);
    // ä¿å­˜åˆ°æ•°æ®åº“
});
```

### Q6: ä¸ºä»€ä¹ˆç”¨ IPFS è€Œä¸æ˜¯æ™®é€šæœåŠ¡å™¨ï¼Ÿ

**A**: 

| ç‰¹æ€§ | æ™®é€šæœåŠ¡å™¨ | IPFS |
|------|-----------|------|
| ä¸­å¿ƒåŒ– | âœ… æ˜¯ | âŒ å¦ |
| å¯èƒ½å…³é—­ | âœ… å¯èƒ½ | âŒ ä¸ä¼š |
| å¯ä»¥ä¿®æ”¹ | âœ… å¯ä»¥ | âŒ ä¸å¯ä»¥ |
| æˆæœ¬ | é«˜ | ä½ |

**ç¤ºä¾‹**ï¼š

```
æ™®é€šæœåŠ¡å™¨ï¼š
ç…§ç‰‡ â†’ ä¸Šä¼ åˆ° AWS â†’ https://aws.com/photo123.jpg
      â†‘ å¦‚æœ AWS åˆ é™¤æ–‡ä»¶ï¼Œé“¾æ¥å°±å¤±æ•ˆäº†

IPFSï¼š
ç…§ç‰‡ â†’ ä¸Šä¼ åˆ° IPFS â†’ ipfs://QmXxx...
      â†‘ ç…§ç‰‡çš„å“ˆå¸Œå€¼ï¼Œå†…å®¹ä¸å˜å“ˆå¸Œå°±ä¸å˜
      â†‘ åˆ†å¸ƒåœ¨å…¨çƒå¤šä¸ªèŠ‚ç‚¹ï¼Œæ°¸ä¸ä¸¢å¤±
```

---

## ğŸ“– å­¦ä¹ è·¯å¾„

### ç¬¬1å¤©ï¼šç†è§£æ¦‚å¿µ

- [ ] é˜…è¯»æœ¬æ–‡æ¡£çš„"Web3 åŸºç¡€æ¦‚å¿µ"éƒ¨åˆ†
- [ ] ç†è§£é’±åŒ…ã€æ™ºèƒ½åˆçº¦ã€Gas çš„æ¦‚å¿µ
- [ ] è§‚çœ‹è§†é¢‘ï¼š[ä»€ä¹ˆæ˜¯åŒºå—é“¾ï¼Ÿ](https://www.youtube.com/watch?v=SSo_EIwHSd4)

### ç¬¬2å¤©ï¼šè¿è¡Œé¡¹ç›®

- [ ] æŒ‰ç…§"å®æˆ˜æ¼”ç»ƒ"éƒ¨åˆ†æ“ä½œ
- [ ] æ³¨å†Œä½ çš„ç¬¬ä¸€ä¸ªèµ„äº§
- [ ] å°è¯•ä¸Šæ¶å’Œè´­ä¹°

### ç¬¬3å¤©ï¼šé˜…è¯»ä»£ç 

- [ ] é˜…è¯» `AssetRegistryV3.sol`ï¼ˆæ™ºèƒ½åˆçº¦ï¼‰
- [ ] ç†è§£ `registerAsset()` å‡½æ•°
- [ ] ç†è§£ `createOrder()` å‡½æ•°

### ç¬¬4å¤©ï¼šä¿®æ”¹ä»£ç 

- [ ] å°è¯•ä¿®æ”¹åˆçº¦ï¼ˆæ·»åŠ æ–°åŠŸèƒ½ï¼‰
- [ ] é‡æ–°éƒ¨ç½²
- [ ] æµ‹è¯•æ–°åŠŸèƒ½

### ç¬¬5å¤©ï¼šæ·±å…¥å­¦ä¹ 

- [ ] å­¦ä¹  Solidity è¯­æ³•
- [ ] å­¦ä¹  Ethers.js ç”¨æ³•
- [ ] é˜…è¯»å®‰å…¨å®¡è®¡æŠ¥å‘Š

---

## ğŸ› ï¸ å¼€å‘å·¥å…·

### å¿…å¤‡å·¥å…·

1. **MetaMask** - ä»¥å¤ªåŠé’±åŒ…
   - ä¸‹è½½ï¼šhttps://metamask.io/
   - ç”¨é€”ï¼šç®¡ç†è´¦æˆ·ã€ç­¾åäº¤æ˜“

2. **Hardhat** - æ™ºèƒ½åˆçº¦å¼€å‘æ¡†æ¶
   - æ–‡æ¡£ï¼šhttps://hardhat.org/
   - ç”¨é€”ï¼šç¼–è¯‘ã€éƒ¨ç½²ã€æµ‹è¯•åˆçº¦

3. **Ethers.js** - åŒºå—é“¾äº¤äº’åº“
   - æ–‡æ¡£ï¼šhttps://docs.ethers.org/
   - ç”¨é€”ï¼šè¿æ¥é’±åŒ…ã€è°ƒç”¨åˆçº¦

### æ¨èå·¥å…·

4. **Remix** - åœ¨çº¿ Solidity IDE
   - åœ°å€ï¼šhttps://remix.ethereum.org/
   - ç”¨é€”ï¼šåœ¨çº¿ç¼–å†™å’Œæµ‹è¯•åˆçº¦

5. **Etherscan** - åŒºå—é“¾æµè§ˆå™¨
   - åœ°å€ï¼šhttps://etherscan.io/
   - ç”¨é€”ï¼šæŸ¥çœ‹äº¤æ˜“ã€åˆçº¦

---

## ğŸ“š å­¦ä¹ èµ„æº

### å…¥é—¨æ•™ç¨‹

1. **Solidity å®˜æ–¹æ–‡æ¡£**
   - https://docs.soliditylang.org/
   - å­¦ä¹ æ™ºèƒ½åˆçº¦è¯­è¨€

2. **CryptoZombies**
   - https://cryptozombies.io/
   - é€šè¿‡æ¸¸æˆå­¦ä¹  Solidity

3. **Ethers.js æ–‡æ¡£**
   - https://docs.ethers.org/
   - å­¦ä¹ å¦‚ä½•ä¸åŒºå—é“¾äº¤äº’

### è¿›é˜¶èµ„æº

4. **OpenZeppelin**
   - https://docs.openzeppelin.com/
   - å­¦ä¹ å®‰å…¨çš„åˆçº¦å¼€å‘

5. **Hardhat æ•™ç¨‹**
   - https://hardhat.org/tutorial
   - å­¦ä¹ å¼€å‘æµç¨‹

---

## ğŸ¯ å…³é”®æœ¯è¯­è¡¨

| æœ¯è¯­ | è§£é‡Š | ç±»æ¯” |
|------|------|------|
| é’±åŒ… | å­˜å‚¨åŠ å¯†è´§å¸çš„åœ°æ–¹ | é“¶è¡Œè´¦æˆ· |
| åœ°å€ | é’±åŒ…çš„å…¬å¼€æ ‡è¯† | é“¶è¡Œå¡å· |
| ç§é’¥ | æ§åˆ¶é’±åŒ…çš„å¯†ç  | é“¶è¡Œå¡å¯†ç  |
| æ™ºèƒ½åˆçº¦ | è‡ªåŠ¨æ‰§è¡Œçš„ç¨‹åº | è‡ªåŠ¨å”®è´§æœº |
| Gas | äº¤æ˜“æ‰‹ç»­è´¹ | é«˜é€Ÿå…¬è·¯è¿‡è·¯è´¹ |
| Wei | æœ€å°çš„ ETH å•ä½ | åˆ†ï¼ˆäººæ°‘å¸çš„æœ€å°å•ä½ï¼‰|
| ABI | åˆçº¦æ¥å£å®šä¹‰ | äº§å“è¯´æ˜ä¹¦ |
| äº‹ä»¶ | åˆçº¦å‘å‡ºçš„é€šçŸ¥ | çŸ­ä¿¡é€šçŸ¥ |
| IPFS | å»ä¸­å¿ƒåŒ–å­˜å‚¨ | åˆ†å¸ƒå¼ç½‘ç›˜ |
| æ‰˜ç®¡ | èµ„é‡‘æš‚æ—¶é”å®š | æ”¯ä»˜å®æ‹…ä¿äº¤æ˜“ |

---

## ğŸ’ª å®è·µå»ºè®®

### å­¦ä¹ æ–¹æ³•

1. **å…ˆè¿è¡Œï¼Œå†ç†è§£**
   - ä¸è¦ä¸€å¼€å§‹å°±çœ‹ä»£ç 
   - å…ˆè¿è¡Œé¡¹ç›®ï¼Œä½“éªŒåŠŸèƒ½
   - ç„¶åå†çœ‹ä»£ç ï¼Œç†è§£å®ç°

2. **ä»ç®€å•åˆ°å¤æ‚**
   - å…ˆç†è§£æ³¨å†Œèµ„äº§ï¼ˆç®€å•ï¼‰
   - å†ç†è§£è´­ä¹°æµç¨‹ï¼ˆä¸­ç­‰ï¼‰
   - æœ€åç†è§£æ‰˜ç®¡æœºåˆ¶ï¼ˆå¤æ‚ï¼‰

3. **å¤šåŠ¨æ‰‹ï¼Œå¤šå®éªŒ**
   - ä¿®æ”¹ä»£ç ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ
   - æ•…æ„è¾“å…¥é”™è¯¯æ•°æ®ï¼Œçœ‹çœ‹é”™è¯¯æç¤º
   - å°è¯•æ”»å‡»åˆçº¦ï¼Œç†è§£å®‰å…¨æœºåˆ¶

### è°ƒè¯•æŠ€å·§

1. **ä½¿ç”¨ console.log**
```typescript
// å‰ç«¯è°ƒè¯•
console.log("ç”¨æˆ·åœ°å€:", account);
console.log("èµ„äº§ä¿¡æ¯:", asset);
```

2. **æŸ¥çœ‹ MetaMask äº¤æ˜“**
```
MetaMask â†’ æ´»åŠ¨ â†’ ç‚¹å‡»äº¤æ˜“ â†’ æŸ¥çœ‹è¯¦æƒ…
```

3. **æŸ¥çœ‹åç«¯æ—¥å¿—**
```bash
tail -f logs/backend.log
```

4. **ä½¿ç”¨ Hardhat Console**
```bash
npx hardhat console --network localhost
```

---

## ğŸ“ å­¦ä¹ è®¡åˆ’ï¼ˆ2å‘¨ï¼‰

### Week 1ï¼šåŸºç¡€

**Day 1-2**: ç†è§£æ¦‚å¿µ
- Web3 æ˜¯ä»€ä¹ˆ
- åŒºå—é“¾åŸºç¡€
- æ™ºèƒ½åˆçº¦åŸç†

**Day 3-4**: è¿è¡Œé¡¹ç›®
- éƒ¨ç½² ChainVault
- æ³¨å†Œèµ„äº§
- å®Œæˆäº¤æ˜“

**Day 5-7**: é˜…è¯»ä»£ç 
- æ™ºèƒ½åˆçº¦ä»£ç 
- åç«¯ä»£ç 
- å‰ç«¯ä»£ç 

### Week 2ï¼šè¿›é˜¶

**Day 8-10**: ä¿®æ”¹ä»£ç 
- æ·»åŠ æ–°åŠŸèƒ½
- ä¿®å¤ bug
- ä¼˜åŒ–æ€§èƒ½

**Day 11-12**: å®‰å…¨å­¦ä¹ 
- ç†è§£å¸¸è§æ¼æ´
- å­¦ä¹ å®‰å…¨æœ€ä½³å®è·µ
- ä¿®å¤å®‰å…¨é—®é¢˜

**Day 13-14**: æ€»ç»“æå‡
- æ•´ç†ç¬”è®°
- å‡†å¤‡æ¼”ç¤º
- å†™ç®€å†

---

## ğŸ‰ æ­å–œä½ ï¼

å¦‚æœä½ çœ‹åˆ°è¿™é‡Œï¼Œè¯´æ˜ä½ å·²ç»å‡†å¤‡å¥½å¼€å§‹ Web3 ä¹‹æ—…äº†ï¼

**è®°ä½**ï¼š
- ğŸ¢ ä¸è¦æ€¥ï¼Œæ…¢æ…¢æ¥
- ğŸ’ª å¤šåŠ¨æ‰‹ï¼Œå¤šå®è·µ
- ğŸ¤ é‡åˆ°é—®é¢˜ï¼ŒæŸ¥æ–‡æ¡£
- ğŸ¯ ç†è§£åŸç†ï¼Œè€Œä¸æ˜¯æ­»è®°ç¡¬èƒŒ

**å¼€å§‹ä½¿ç”¨ ChainVaultï¼Œå¼€å¯ä½ çš„ Web3 ä¹‹æ—…ï¼** ğŸš€

---

## ğŸ“ è·å–å¸®åŠ©

### æŸ¥çœ‹æ–‡æ¡£

```bash
# å¿«é€Ÿå¼€å§‹
cat å¼€å§‹ä½¿ç”¨.md

# è¯¦ç»†éƒ¨ç½²
cat V3_DEPLOYMENT_GUIDE.md

# ä»£ç æ³¨é‡Š
cat CODE_DOCUMENTATION.md
```

### åœ¨çº¿èµ„æº

- [Ethereum å®˜ç½‘](https://ethereum.org/)
- [Solidity æ–‡æ¡£](https://docs.soliditylang.org/)
- [Ethers.js æ–‡æ¡£](https://docs.ethers.org/)
- [Hardhat æ–‡æ¡£](https://hardhat.org/)

---

**ç¥ä½ å­¦ä¹ æ„‰å¿«ï¼** ğŸ“šâœ¨

**æ–‡æ¡£ç‰ˆæœ¬**: V1.0  
**é€‚åˆäººç¾¤**: Web3 æ–°æ‰‹  
**é¢„è®¡å­¦ä¹ æ—¶é—´**: 2å‘¨  
**æœ€åæ›´æ–°**: 2024-12-19

